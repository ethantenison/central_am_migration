---
title: "Central American Migration"
author: "Ethan Tenison"
date: "2/6/2020"
output: html_document
---

```{r setup, message=FALSE}
library(ggplot2)
library(dplyr)
library(janitor)
library(tidyverse)
```


# Plot of Central American Migrantion into the United States. 


```{r CA_migrantion}

options(scipen = 999)
df <- read.csv("census_numbers.csv", stringsAsFactors = FALSE)
df <- clean_names(df)
names(df) <- as.matrix(df[4, ])
df <- df[-1, ]
df <- df[6:238, 1:6]
df <- rename(df, country = "Region and country or area")
df$country <- as.character(df$country)
df <-filter(df,country %in% c("El Salvador", "Honduras", "Guatemala", "Nicaragua"))

df <-rename(
      df,
      "Country" = "country",
      "2000" = "2000*",
      "1990" = "1990*",
      "1980" = "1980*",
      "1970" = "1970*",
      "1960" = "1960*"
   )

df_2010 <- read.csv("./ACS_10_1YR_B05006_with_ann.csv")
names(df_2010) <- as.matrix(df_2010[1,])
df_2010 <- df_2010[-1,]
df_2010 <- clean_names(df_2010)
df_2010 <-select(
      df_2010,
      "estimate_americas_latin_america_central_america_nicaragua",
      "estimate_americas_latin_america_central_america_honduras",
      "estimate_americas_latin_america_central_america_guatemala",
      "estimate_americas_latin_america_central_america_el_salvador"
   )
df_2010 <- rename(
      df_2010,
      "Nicaragua" = "estimate_americas_latin_america_central_america_nicaragua",
      "Honduras" = "estimate_americas_latin_america_central_america_honduras",
      "Guatemala" = "estimate_americas_latin_america_central_america_guatemala" ,
      "El Salvador" = "estimate_americas_latin_america_central_america_el_salvador"
   )
df_2010 <-gather(df_2010, Country, population, "Nicaragua":"El Salvador")
df_2010 <- mutate(df_2010, year = "2010")
#df_2010$year <- as.factor(df_2010$year)
df_2010$population <- as.numeric(df_2010$population)


df <- select(df, "Country", "1960", "1970", "1980", "1990", "2000")
df <- gather(df, year, population, "1960":"2000")
df$population <- as.numeric(gsub(",", "", df$population))
df <- rbind(df, df_2010)
df$year <- as.numeric(df$year)

theme_set(theme_bw())
ggplot(data = df, aes(x = year, y = population, group = Country)) +
   geom_line(aes(color = Country), size = 2) +
   geom_point(aes(color = Country)) +
   ggtitle("Population of foreign born Central Americans in the United States") +
   xlab("Year") +
   ylab("Population") +
   geom_vline(xintercept = 1996, linetype = "dashed") +
   geom_segment(aes(
      x = 1991,
      y = 1000000,
      xend = 1995.5,
      yend = 1000000
   ),
   arrow = arrow(length = unit(0.5, "cm"))) +
   annotate(
      "text",
      x = 1980,
      y = 1000000,
      label = "Illegal Immigration Reform and \n Immigrant Responsibility Act (1996)",
      size = 3.5
   )

ggsave("foreign_born_pop.png")

```